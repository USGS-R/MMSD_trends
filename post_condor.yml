target_default: all

packages:
  - dplyr
  - EGRET
  - scipiper

sources:
  - 1_get_condor_data/src/get_data.R
  - 1_get_condor_data/src/plot_data.R

file_extensions:
  - ind

targets:
  all:
    depends: 
    - lib/cfg/gd_config.yml
    - 1_get_condor_data/out/modeled.rds.ind
    - 1_get_condor_data/doc/plot.pdf
    - 1_get_condor_data/doc/plotConcFluxHist.pdf
    - 1_get_condor_data/doc/fluxBiasMulti.pdf
    
  lib/cfg/gd_config.yml:
    command: gd_config(config_file=target_name, folder=I("1DGJJ1_tc1_92v0uOwL1bqFfPPyqk-nyZ"))
  
  1_get_condor_data/out:
    command: dir.create(target_name, recursive=I(TRUE), showWarnings=I(FALSE))

  1_get_condor_data/raw_condor:
    command: dir.create(target_name, recursive=I(TRUE), showWarnings=I(FALSE))

  1_get_data_ready/out:
    command: dir.create(target_name, recursive=I(TRUE), showWarnings=I(FALSE))
  
  1_get_data_ready/out/merged_flow.rds.ind:
    command: gd_get(target_name)
    
  1_get_condor_data/out/master_list.rds:
    command: saveRDS(object= I(readRDS(as_data_file("1_get_data_ready/out/merged_flow.rds.ind"))), file = I("1_get_condor_data/out/master_list.rds"))

  1_get_condor_data/out/modeled.rds.ind:
    command: get_data("1_get_condor_data/out/master_list.rds", target_name)
    
  1_get_condor_data/out/modeled.rds:
    command: gd_get('1_get_condor_data/out/modeled.rds.ind')
    
  1_get_condor_data/out/master_list.rds.ind:
    command: gd_put(remote_ind=target_name, local_source="1_get_condor_data/out/master_list.rds")

  master_list:
    command: get_master_list("1_get_condor_data/out/master_list.rds.ind")

  1_get_condor_data/doc:
    command: dir.create(target_name, recursive=I(TRUE), showWarnings=I(FALSE))
  
  1_get_condor_data/doc/plot.pdf:
    command: plot_data(master_list,"1_get_condor_data/out/modeled.rds", target_name)
    
  1_get_condor_data/doc/plotConcFluxHist.pdf:
    command: plot_conc_flux(master_list,"1_get_condor_data/out/modeled.rds", target_name)
    
  1_get_condor_data/doc/fluxBiasMulti.pdf:
    command: plot_bias(master_list,"1_get_condor_data/out/modeled.rds", target_name)
